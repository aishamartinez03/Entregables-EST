library(rio)
data= import("https://raw.githubusercontent.com/aishamartinez03/Entregables-EST/main/datafinal.csv")
modelo= lm(scoredemo ~ scorelibeco + scoreparpol + scorepbi, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo1=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal",
stars = TRUE,
output = "kableExtra")
modelo= lm(scoredemo ~  cpiscore + educasec + gini_ind, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo2=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal 2",
stars = TRUE,
output = "kableExtra")
library(stargazer)
stargazer(modelo1,modelo2, type ="text")
modelo= lm(scoredemo ~  cpiscore + educasec + gini_ind + scorelibeco + scoreparpol + scorepbi, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo3=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal",
stars = TRUE,
output = "kableExtra")
dontselect=c("country")
select=setdiff(names(data),dontselect)
theData=data[,select]
library(polycor)
corMatrix=polycor::hetcor(theData)$correlations
library(ggcorrplot)
ggcorrplot(corMatrix)
library(psych)
psych::KMO(corMatrix)
cortest.bartlett(corMatrix,n=nrow(theData))$p.value>0.05
library(matrixcalc)
is.singular.matrix(corMatrix)
fa.parallel(theData, fa = 'fa',correct = T,plot = F)
library(GPArotation)
resfa <- fa(theData,
nfactors = 2,
cor = 'mixed',
rotate = "varimax",
fm="minres")
print(resfa$loadings)
print(resfa$loadings,cutoff = 0.5)
fa.diagram(resfa,main = "Resultados del EFA")
sort(resfa$communality)
sort(resfa$complexity)
library(magrittr)
as.data.frame(resfa$scores)%>%head()
data$scorelibeco=resfa$scores[,1]
data$cpiscore=resfa$scores[,2]
ggplot(data=data, aes(x=scorelibeco,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA")
ggplot(data=data, aes(x=cpiscore,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA")
library(BBmisc)
scoredemo=normalize(resfa$scores,
method = "range",
margin=2, # by column
range = c(0, 10))
data$scorelibeco=scoredemo[,1]
data$cpiscore=scoredemo[,2]
ggplot(data=data,aes(x=scorelibeco,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA (cambiado)")
scoredemo=normalize(resfa$scores,
method = "range",
margin=2, # by column
range = c(0, 10))
data$scorelibeco=scoredemo[,1]
data$cpiscore=scoredemo[,2]
ggplot(data=data,aes(x=cpiscore,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA (cambiado)")
library(rio)
data= import("https://raw.githubusercontent.com/aishamartinez03/Entregables-EST/main/datafinal.csv")
modelo= lm(scoredemo ~ scorelibeco + scoreparpol + scorepbi, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo1=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal",
stars = TRUE,
output = "kableExtra")
modelo= lm(scoredemo ~  cpiscore + educasec + gini_ind, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo2=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal 2",
stars = TRUE,
output = "kableExtra")
library(stargazer)
stargazer(modelo1,modelo2, type ="text")
modelo= lm(scoredemo ~  cpiscore + educasec + gini_ind + scorelibeco + scoreparpol + scorepbi, data=data)
summary(modelo)
equatiomatic::extract_eq(modelo, use_coefs = TRUE)
library(knitr)
library(modelsummary)
modelo3=list('OLS asegurados (I)'=modelo)
modelsummary(modelo, title = "Resumen de Regresion Lineal",
stars = TRUE,
output = "kableExtra")
dontselect=c("country")
select=setdiff(names(data),dontselect)
theData=data[,select]
library(polycor)
corMatrix=polycor::hetcor(theData)$correlations
library(ggcorrplot)
ggcorrplot(corMatrix)
library(psych)
psych::KMO(corMatrix)
cortest.bartlett(corMatrix,n=nrow(theData))$p.value>0.05
library(matrixcalc)
is.singular.matrix(corMatrix)
fa.parallel(theData, fa = 'fa',correct = T,plot = F)
library(GPArotation)
resfa <- fa(theData,
nfactors = 2,
cor = 'mixed',
rotate = "varimax",
fm="minres")
print(resfa$loadings)
print(resfa$loadings,cutoff = 0.5)
fa.diagram(resfa,main = "Resultados del EFA")
sort(resfa$communality)
sort(resfa$complexity)
library(magrittr)
as.data.frame(resfa$scores)%>%head()
data$scorelibeco=resfa$scores[,1]
data$cpiscore=resfa$scores[,2]
ggplot(data=data, aes(x=scorelibeco,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA")
ggplot(data=data, aes(x=cpiscore,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA")
library(BBmisc)
scoredemo=normalize(resfa$scores,
method = "range",
margin=2, # by column
range = c(0, 10))
data$scorelibeco=scoredemo[,1]
data$cpiscore=scoredemo[,2]
ggplot(data=data,aes(x=scorelibeco,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA (cambiado)")
scoredemo=normalize(resfa$scores,
method = "range",
margin=2, # by column
range = c(0, 10))
data$scorelibeco=scoredemo[,1]
data$cpiscore=scoredemo[,2]
ggplot(data=data,aes(x=cpiscore,y=scoredemo)) + geom_point() + theme_minimal() + labs(x="Indice de Democracia (original)", y="Indice de Democracia EFA (cambiado)")
dataClus=data[,c(2:8)]
row.names(dataClus)=data$country
library(cluster)
g.dist = daisy(dataClus, metric="gower")
fviz_nbclust(dataClus, hcut,diss=g.dist,method = "gap_stat",k.max = 10,verbose = F,hc_func = "diana")
library(profvis)
fviz_nbclust(dataClus, hcut,diss=g.dist,method = "gap_stat",k.max = 10,verbose = F,hc_func = "diana")
library(factoextra)
fviz_nbclust(dataClus, hcut,diss=g.dist,method = "gap_stat",k.max = 10,verbose = F,hc_func = "diana")
set.seed(123)
res.diana <- hcut(g.dist, k = 2,hc_func='diana')
dataClus$diana=res.diana$cluster
head(dataClus,15)%>%kbl%>%kable_styling()
library(kableExtra)
set.seed(123)
res.diana <- hcut(g.dist, k = 2,hc_func='diana')
dataClus$diana=res.diana$cluster
head(dataClus,15)%>%kbl%>%kable_styling()
fviz_dend(res.diana, cex = 0.7, horiz = T, main = "")
fviz_silhouette(res.diana,print.summary = F)
aggregate(.~ diana, data=dataClus,mean)
original=aggregate(.~ diana, data=dataClus,mean)
original[order(original$scoredemo),]
dataClus$diana=dplyr::recode(dataClus$diana, `1` = 2, `2`=1)
data$dianadatapoor=data$Pais
data$dianadata=as.ordered(dataClus$diana)
dataClus$diana=NULL
proyeccion = cmdscale(g.dist, k=2,add = T)
head(proyeccion$points,20)
data$dim1 <- proyeccion$points[,1]
data$dim2 <- proyeccion$points[,2]
library(ggrepel)
base= ggplot(data,aes(x=dim1, y=dim2,label=row.names(dataClus)))
base + geom_text_repel(size=3, max.overlaps = 50,min.segment.length = unit(0, 'lines'))
